# 实验名称
MPT_report

# 实验简介
research report on MPT

# 实验完成人
权周雨 

学号：202000460021 

git账户名称：baekhunee

# 前言

## 前缀树
前缀树（又称字典树），用于保存关联数组，其键（key）的内容通常为字符串。前缀树节点在树中的位置是由其键的内容所决定的，即前缀树的key值被编码在根节点到该节点的路径中。

如下图所示，图中共有6个叶子节点，其key的值分别为（1）tc（2）tea（3）ted（4）ten（5）Ab（6）il

![image](https://user-images.githubusercontent.com/105578152/181406571-3a835e02-2622-42e0-b6f7-f2e759bcc972.png)

### 优势
1、相比于哈希表，使用前缀树来进行查询拥有共同前缀key的数据时十分高效，例如在字典中查找前缀为pre的单词，对于哈希表来说，需要遍历整个表，时间效率为O(n)；然而对于前缀树来说，只需要在树中找到前缀为pre的节点，且遍历以这个节点为根节点的子树即可。

2、相比于哈希表，在前缀树不会存在哈希冲突的问题

### 劣势
1、直接查找效率低下

前缀树的查找效率是O(m)，m为所查找节点的key长度，而哈希表的查找效率为O(1)。且一次查找会有m次IO开销，相比于直接查找，无论是速率、还是对磁盘的压力都比较大。

2、可能造成空间浪费

当存在一个节点，其key值内容很长（如一串很长的字符串），当树中没有与他相同前缀的分支时，为了存储该节点，需要创建许多非叶子节点来构建根节点到该节点间的路径，造成了存储空间的浪费。

## Merkle Tree
### 特点
1、默克尔树是一种树，大多数是二叉树，也可以多叉树，无论是几叉树，它都具有树结构的所有特点；

2、默克尔树叶子节点的value是数据项的内容，或者是数据项的哈希值；

3、非叶子节点的value根据其孩子节点的信息，然后按照Hash算法计算而得出的。

### 原理
在比特币网络中，merkle树是自底向上构建的，如下图所示：
![image](https://user-images.githubusercontent.com/105578152/181407089-4306e26a-0d3d-48ca-a2de-5e88f7d76f47.png)
将相邻两个节点的哈希值合并成一个字符串，然后计算这个字符串的哈希，得到的就是这两个节点的父节点的哈希值。若两棵树的根哈希一致，则这两棵树的结构、节点的内容必然相同。

### 优势
1、快速重哈希
默克尔树的特点之一就是当树节点内容发生变化时，能够在前一次哈希计算的基础上，仅仅将被修改的树节点进行哈希重计算，便能得到一个新的根哈希用来代表整棵树的状态。

2、轻节点扩展
采用默克尔树，可以在公链环境下扩展一种“轻节点”。轻节点的特点是对于每个区块，仅仅需要存储约80个字节大小的区块头数据，而不存储交易列表，回执列表等数据。然而通过轻节点，可以实现在非信任的公链环境中验证某一笔交易是否被收录在区块链账本的功能。这使得像比特币，以太坊这样的区块链能够运行在个人PC，智能手机等拥有小存储容量的终端上。

### 劣势
存储空间开销大

# 概述

Merkle Patricia Tree（又称Merkle Patricia Trie）是一种经过改良的、融合了默克尔树和前缀树两种树结构优点的数据结构，是以太坊中用来组织管理账户数据、生成交易集合哈希的重要数据结构。

MPT树有以下几个作用：

存储任意长度的key-value键值对数据；
提供了一种快速计算所维护数据集哈希标识的机制；
提供了快速状态回滚的机制；
提供了一种称为默克尔证明的证明方法，进行轻节点的扩展，实现简单支付验证；
由于MPT结合了（1）前缀树（2）默克尔树两种树结构的特点与优势 ，因此在介绍MPT之前，我们首先简要地介绍下这两种树结构的特点。
